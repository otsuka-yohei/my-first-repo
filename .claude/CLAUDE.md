# CLAUDE.md - グローバル開発設定

## 基本設定

### 言語設定
- **コミュニケーション言語**: 日本語
- すべてのやり取りは日本語で行う
- コード内のコメントも原則日本語（ただし、OSSや国際プロジェクトは英語）

## コーディング規約

### 一般原則
- **可読性優先**: パフォーマンスより読みやすさを重視
- **DRY原則**: 重複を避ける
- **KISS原則**: シンプルに保つ
- **早期リターン**: ネストを深くしない

### 命名規則
- 変数名・関数名は意図が明確にわかる名前を使用
- 略語は避ける（ただし一般的なものは可: url, api, id等）
- マジックナンバーは定数として定義

## プロジェクト構造

### 推奨ディレクトリ構成
```
project/
├── tests/            # テストコード
├── docs/             # ドキュメント
├── scripts/          # ユーティリティスクリプト
└── README.md         # プロジェクト概要
```

## 開発フロー

### タスク管理
- 複雑なタスクは小さなステップに分解
- 各ステップの完了を確認してから次へ進む
- 不明な点は実装前に確認

### コードレビュー観点
1. 要件を満たしているか
2. エラーハンドリングは適切か
3. リントチェックをパスしているか
4. ドキュメントは更新されているか

## ドキュメント規約
- **README.md**: 必ず以下を含める
  - プロジェクト概要
  - セットアップ手順
  - 使用方法
  - 開発者向け情報
- **コード内コメント**: 「なぜ」を説明（「何を」ではない）
- **変更履歴**: 重要な変更は記録を残す

## Git運用ルール
- **コミットメッセージ**: 日本語で具体的に記述
  - 例: "ユーザー認証機能を追加"
  - 例: "商品検索のパフォーマンスを改善"
- **ブランチ戦略**: 
  - main: 本番環境
  - develop: 開発環境
  - feature/機能名: 機能開発
  - fix/バグ名: バグ修正

## セキュリティ指針
- 秘密情報は絶対にコミットしない
- 環境変数で設定を管理
- ユーザー入力は必ず検証
- 依存関係は定期的に更新

## パフォーマンス指針
- 最適化は計測してから
- ボトルネックを特定してから改善
- キャッシュは適切に活用
- 非同期処理を効果的に使用

## エラーハンドリング
- すべてのエラーを適切に処理
- ユーザーには分かりやすいメッセージを表示
- ログには詳細な情報を記録
- リトライ可能なエラーは自動リトライ
- 関連が薄く見えるエラーでも必ず解決する
- エラーの抑制（@ts-ignore、try-catch で握りつぶす等）ではなく、根本原因を修正
- 早期にエラーを検出し、明確なエラーメッセージを提供
- エラーケースも必ずテストでカバーする
- 外部APIやネットワーク通信は必ず失敗する可能性を考慮

## AIアシスタントへの指示
1. **言語**: 常に日本語でコミュニケーション
2. **確認**: 不明な点は実装前に必ず確認
3. **既存コード**: 既存のコードスタイルに従う
4. **リントチェック**: コード変更後は必ずリントチェックを実行
5. **簡潔性**: 回答は簡潔かつ的確に
6. **CLAUDE.md管理**: 
   - やり取りで得られた重要な知見はプロジェクトのCLAUDE.mdに追記
   - 仕様変更や新しい決定事項は既存の内容を更新
   - プロジェクト固有の規約や注意点を継続的に文書化

## デバッグ方針
- 問題の再現手順を明確にする
- ログを活用して原因を特定
- 小さな変更で検証を繰り返す
- 根本原因を解決する（対症療法は避ける）

## コードレビュー時の注意点
- 建設的なフィードバックを心がける
- 良い点も指摘する
- 改善案を具体的に提示
- 議論は実装の詳細より設計に注力

## テスト規律
- テストをスキップせず、問題があれば修正する
- 実装詳細ではなく振る舞いをテスト
- テスト間の依存を避け、任意の順序で実行可能に
- テストは高速で、常に同じ結果を返すように
- カバレッジは指標であり、質の高いテストを重視

## 保守性とリファクタリング
- 機能追加と同時に既存コードの改善を検討
- 大規模な変更は小さなステップに分割
- 使用されていないコードは積極的に削除
- 依存関係は定期的に更新（セキュリティと互換性のため）
- 技術的負債は明示的にコメントやドキュメントに記録